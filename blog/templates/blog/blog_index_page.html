{% extends "base.html" %}

{% load wagtailcore_tags wagtailimages_tags %}

{% block body_class %} template-blogindexpage {% endblock %}

{% block content %}

    {% if user.is_authenticated %}
      <p class="display-4">Hello, {{ user.username }}</p>
    {% else %}
      <a class="lead" href="{% url 'login' %}">Log in</a>
    {% endif %}

    <h1>{{ page.title }}</h1>

    {% with blocks=self.body %}
      {% for block in blocks %}
          {% if block.block_type == 'heading' %}
              <h2>{{ block.value }}</h2>
          {% else %}
             <section class="block-{{ block.block_type }}">
                 {{ block }}
             </section>
          {% endif %}
      {% endfor %}
    {% endwith %}


    {% for post in page.get_children.specific %}

        <a href="{% pageurl post %}">
          {{ post.title }}
          {% image post.miniature fill-1000x1000 %}
        </a>

        <!-- Blocks if needed -->
        {% for block in post.body %}
        {% endfor %}

    {% endfor %}

{% endblock %}
